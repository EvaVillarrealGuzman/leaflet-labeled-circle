(function(t){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=t()}else if(typeof define==="function"&&define.amd){define([],t)}else{var e;if(typeof window!=="undefined"){e=window}else if(typeof global!=="undefined"){e=global}else if(typeof self!=="undefined"){e=self}else{e=this}(e.L||(e.L={})).LabeledCircleMarker=t()}})(function(){var t,e,i;return function a(t,e,i){function r(s,o){if(!e[s]){if(!t[s]){var h=typeof require=="function"&&require;if(!o&&h)return h(s,!0);if(n)return n(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var _=e[s]={exports:{}};t[s][0].call(_.exports,function(e){var i=t[s][1][e];return r(i?i:e)},_,_.exports,a,t,e,i)}return e[s].exports}var n=typeof require=="function"&&require;for(var s=0;s<i.length;s++)r(i[s]);return r}({1:[function(t,e,i){"use strict";/**
 * Leaflet SVG circle marker with detachable and draggable label and text
 *
 * @author Alexander Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 */
e.exports=t("./src/marker")},{"./src/marker":9}],2:[function(t,e,i){t("./src/SVG");t("./src/SVG.VML");t("./src/Canvas");t("./src/Path.Transform");t("./src/Path.Drag");e.exports=L.Path.Drag},{"./src/Canvas":3,"./src/Path.Drag":4,"./src/Path.Transform":5,"./src/SVG":7,"./src/SVG.VML":6}],3:[function(t,e,i){L.Util.trueFn=function(){return true};L.Canvas.include({_resetTransformPath:function(t){if(!this._containerCopy){return}delete this._containerCopy;if(t._containsPoint_){t._containsPoint=t._containsPoint_;delete t._containsPoint_;this._requestRedraw(t);this._draw(true)}},transformPath:function(t,e){var i=this._containerCopy;var a=this._ctx;var r=L.Browser.retina?2:1;var n=this._bounds;var s=n.getSize();var o=n.min;if(!i){i=this._containerCopy=document.createElement("canvas");document.body.appendChild(i);i.width=r*s.x;i.height=r*s.y;t._removed=true;this._redraw();i.getContext("2d").translate(r*n.min.x,r*n.min.y);i.getContext("2d").drawImage(this._container,0,0);this._initPath(t);t._containsPoint_=t._containsPoint;t._containsPoint=L.Util.trueFn}a.save();a.clearRect(o.x,o.y,s.x*r,s.y*r);a.setTransform(1,0,0,1,0,0);a.restore();a.save();a.drawImage(this._containerCopy,0,0,s.x,s.y);a.transform.apply(a,e);var h=this._layers;this._layers={};this._initPath(t);t._updatePath();this._layers=h;a.restore()}})},{}],4:[function(t,e,i){L.Handler.PathDrag=L.Handler.extend({statics:{DRAGGING_CLS:"leaflet-path-draggable"},initialize:function(t){this._path=t;this._matrix=null;this._startPoint=null;this._dragStartPoint=null;this._mapDraggingWasEnabled=false},addHooks:function(){this._path.on("mousedown",this._onDragStart,this);this._path.options.className=this._path.options.className?this._path.options.className+" "+L.Handler.PathDrag.DRAGGING_CLS:L.Handler.PathDrag.DRAGGING_CLS;if(this._path._path){L.DomUtil.addClass(this._path._path,L.Handler.PathDrag.DRAGGING_CLS)}},removeHooks:function(){this._path.off("mousedown",this._onDragStart,this);this._path.options.className=this._path.options.className.replace(new RegExp("\\s+"+L.Handler.PathDrag.DRAGGING_CLS),"");if(this._path._path){L.DomUtil.removeClass(this._path._path,L.Handler.PathDrag.DRAGGING_CLS)}},moved:function(){return this._path._dragMoved},_onDragStart:function(t){var e=t.originalEvent._simulated?"touchstart":t.originalEvent.type;this._mapDraggingWasEnabled=false;this._startPoint=t.containerPoint.clone();this._dragStartPoint=t.containerPoint.clone();this._matrix=[1,0,0,1,0,0];L.DomEvent.stop(t.originalEvent);L.DomUtil.addClass(this._path._renderer._container,"leaflet-interactive");L.DomEvent.on(document,L.Draggable.MOVE[e],this._onDrag,this).on(document,L.Draggable.END[e],this._onDragEnd,this);if(this._path._map.dragging.enabled()){this._path._map.dragging._draggable._onUp();this._path._map.dragging.disable();this._mapDraggingWasEnabled=true}this._path._dragMoved=false;if(this._path._popup){this._path._popup._close()}this._replaceCoordGetters(t)},_onDrag:function(t){L.DomEvent.stop(t);var e=t.touches&&t.touches.length>=1?t.touches[0]:t;var i=this._path._map.mouseEventToContainerPoint(e);var a=i.x;var r=i.y;var n=a-this._startPoint.x;var s=r-this._startPoint.y;if(!this._path._dragMoved&&(n||s)){this._path._dragMoved=true;this._path.fire("dragstart",t);this._path.bringToFront()}this._matrix[4]+=n;this._matrix[5]+=s;this._startPoint.x=a;this._startPoint.y=r;this._path.fire("predrag",t);this._path._transform(this._matrix);this._path.fire("drag",t)},_onDragEnd:function(t){var e=this._path._map.mouseEventToContainerPoint(t);if(this.moved()){this._transformPoints(this._matrix);this._path._updatePath();this._path._project();this._path._transform(null)}L.DomEvent.off(document,"mousemove touchmove",this._onDrag,this).off(document,"mouseup touchend",this._onDragEnd,this);this._path.fire("dragend",{distance:Math.sqrt(L.LineUtil._sqDist(this._dragStartPoint,e))});this._matrix=null;this._startPoint=null;this._dragStartPoint=null;if(this._mapDraggingWasEnabled){this._path._map.dragging.enable()}this._restoreCoordGetters()},_transformPoints:function(t,e){var i=this._path;var a,r,n;var s=L.point(t[4],t[5]);var o=i._map.options.crs;var h=o.transformation;var l=o.scale(i._map.getZoom());var _=o.projection;var p=h.untransform(s,l).subtract(h.untransform(L.point(0,0),l));var g=!e;i._bounds=new L.LatLngBounds;if(i._point){e=_.unproject(_.project(i._latlng)._add(p));if(g){i._latlng=e;i._point._add(s)}}else if(i._rings||i._parts){var d=i._rings||i._parts;var f=i._latlngs;e=e||f;if(!L.Util.isArray(f[0])){f=[f];e=[e]}for(a=0,r=d.length;a<r;a++){e[a]=e[a]||[];for(var u=0,c=d[a].length;u<c;u++){n=f[a][u];e[a][u]=_.unproject(_.project(n)._add(p));if(g){i._bounds.extend(f[a][u]);d[a][u]._add(s)}}}}return e},_replaceCoordGetters:function(){if(this._path.getLatLng){this._path.getLatLng_=this._path.getLatLng;this._path.getLatLng=L.Util.bind(function(){return this.dragging._transformPoints(this.dragging._matrix,{})},this._path)}else if(this._path.getLatLngs){this._path.getLatLngs_=this._path.getLatLngs;this._path.getLatLngs=L.Util.bind(function(){return this.dragging._transformPoints(this.dragging._matrix,[])},this._path)}},_restoreCoordGetters:function(){if(this._path.getLatLng_){this._path.getLatLng=this._path.getLatLng_;delete this._path.getLatLng_}else if(this._path.getLatLngs_){this._path.getLatLngs=this._path.getLatLngs_;delete this._path.getLatLngs_}}});L.Handler.PathDrag.makeDraggable=function(t){t.dragging=new L.Handler.PathDrag(t);return t};L.Path.prototype.makeDraggable=function(){return L.Handler.PathDrag.makeDraggable(this)};L.Path.addInitHook(function(){if(this.options.draggable){this.options.interactive=true;if(this.dragging){this.dragging.enable()}else{L.Handler.PathDrag.makeDraggable(this);this.dragging.enable()}}else if(this.dragging){this.dragging.disable()}})},{}],5:[function(t,e,i){/**
 * Leaflet vector features drag functionality
 * @author Alexander Milevski <info@w8r.name>
 * @preserve
 */
L.Path.include({_transform:function(t){if(this._renderer){if(t){this._renderer.transformPath(this,t)}else{this._renderer._resetTransformPath(this);this._update()}}return this},_onMouseClick:function(t){if(this.dragging&&this.dragging.moved()||this._map.dragging&&this._map.dragging.moved()){return}this._fireMouseEvent(t)}})},{}],6:[function(t,e,i){L.SVG.include(!L.Browser.vml?{}:{_resetTransformPath:function(t){if(t._skew){t._skew.on=false;t._path.removeChild(t._skew);t._skew=null}},transformPath:function(t,e){var i=t._skew;if(!i){i=L.SVG.create("skew");t._path.appendChild(i);i.style.behavior="url(#default#VML)";t._skew=i}var a=e[0].toFixed(8)+" "+e[1].toFixed(8)+" "+e[2].toFixed(8)+" "+e[3].toFixed(8)+" 0 0";var r=Math.floor(e[4]).toFixed()+", "+Math.floor(e[5]).toFixed()+"";var n=this._path.style;var s=parseFloat(n.left);var o=parseFloat(n.top);var h=parseFloat(n.width);var l=parseFloat(n.height);if(isNaN(s)){s=0}if(isNaN(o)){o=0}if(isNaN(h)||!h){h=1}if(isNaN(l)||!l){l=1}var _=(-s/h-.5).toFixed(8)+" "+(-o/l-.5).toFixed(8);i.on="f";i.matrix=a;i.origin=_;i.offset=r;i.on=true}})},{}],7:[function(t,e,i){L.SVG.include({_resetTransformPath:function(t){t._path.setAttributeNS(null,"transform","")},transformPath:function(t,e){t._path.setAttributeNS(null,"transform","matrix("+e.join(" ")+")")}})},{}],8:[function(t,e,i){"use strict";var a=t("leaflet");e.exports=a.CircleMarker.extend({options:{textStyle:{color:"#fff",fontSize:12,fontWeight:300},shiftY:7},initialize:function r(t,e,i){this._text=t;this._textElement=null;this._textNode=null;this._textLayer=null;a.CircleMarker.prototype.initialize.call(this,e,i)},setText:function n(t){this._text=t;if(this._textNode){this._textElement.removeChild(this._textNode)}this._textNode=document.createTextNode(this._text);this._textElement.appendChild(this._textNode);return this},bringToFront:function s(){a.CircleMarker.prototype.bringToFront.call(this);this._groupTextToPath()},bringToBack:function o(){a.CircleMarker.prototype.bringToBack.call(this);this._groupTextToPath()},_groupTextToPath:function h(){var t=this._path;var e=this._textElement;var i=t.nextSibling;var a=t.parentNode;if(e&&a){if(i&&i!==e){a.insertBefore(e,i)}else{a.appendChild(e)}}},_updatePath:function l(){a.CircleMarker.prototype._updatePath.call(this);this._updateTextPosition()},_transform:function _(t){a.CircleMarker.prototype._transform.call(this,t);this._textLayer=this._textLayer||{_path:this._textElement};if(t){this._renderer.transformPath(this._textLayer,t)}else{this._renderer._resetTransformPath(this._textLayer);this._updateTextPosition();this._textLayer=null}},onAdd:function p(t){a.CircleMarker.prototype.onAdd.call(this,t);this._initText();this._updateTextPosition();this.setStyle();return this},_initText:function g(){this._textElement=a.SVG.create("text");this.setText(this._text);this._renderer._rootGroup.appendChild(this._textElement)},_updateTextPosition:function d(){var t=this._textElement;if(t){var e=t.getBBox();var i=this._point.subtract(a.point(e.width,-e.height+this.options.shiftY).divideBy(2));t.setAttribute("x",i.x);t.setAttribute("y",i.y);this._groupTextToPath()}},setStyle:function f(t){a.CircleMarker.prototype.setStyle.call(this,t);var e=this.options.textStyle;for(var i in e){if(e.hasOwnProperty(i)){var r=i;if(i==="color"){r="stroke"}this._textElement.style[r]=e[i]}}}})},{leaflet:undefined}],9:[function(t,e,i){"use strict";var a=t("leaflet");var r=t("./circle");t("leaflet-path-drag");var n=a.FeatureGroup.extend({options:{getLabelText:function s(t,e){return e.properties.text},getLabelPosition:function o(t,e,i){return e.properties.labelPosition?a.latLng(e.properties.labelPosition.slice().reverse()):i},labelPositionKey:"labelPosition",markerOptions:{color:"#f00",fillOpacity:.75,draggable:true,radius:15},anchorOptions:{color:"#00f",radius:3},lineOptions:{color:"#f00",dashArray:[2,6],lineCap:"square",weight:2}},initialize:function h(t,e,i){a.Util.setOptions(this,i);this.feature=e||{type:"Feature",properties:{},geometry:{type:"Point"}};this._latlng=t;this._marker=null;this._anchor=null;this._line=null;this._initialDistance=null;this._createLayers();a.LayerGroup.prototype.initialize.call(this,[this._anchor,this._line,this._marker])},getLabelPosition:function l(){return this._marker.getLatLng()},getLatLng:function _(){return this._latlng},toGeoJSON:function p(){var t=a.GeoJSON.getFeature(this,{type:"Point",coordinates:a.GeoJSON.latLngToCoords(this._anchor.getLatLng())});t.properties[this.options.labelPositionKey]=a.GeoJSON.latLngToCoords(this._marker.getLatLng());return t},setText:function g(t){this._marker.setText(t);return this},_createLayers:function d(){var t=this.options;var e=t.getLabelPosition(this,this.feature,this._latlng);var i=t.getLabelText(this,this.feature);this._marker=new r(i,e,a.Util.extend({},n.prototype.options.markerOptions,t.markerOptions)).on("drag",this._onMarkerDrag,this).on("dragstart",this._onMarkerDragStart,this);this._anchor=new a.CircleMarker(this._latlng,a.Util.extend({},n.prototype.options.anchorOptions,t.anchorOptions));this._line=new a.Polyline([this._latlng,this._marker.getLatLng()],a.Util.extend({},n.prototype.options.lineOptions,t.lineOptions))},_onMarkerDragStart:function f(t){this._initialDistance=a.DomEvent.getMousePosition(t).subtract(this._map.latLngToContainerPoint(this._marker.getLatLng()))},_onMarkerDrag:function u(t){var e=this._map.containerPointToLatLng(a.DomEvent.getMousePosition(t)._subtract(this._initialDistance));this._line.setLatLngs([e,this._latlng])}});e.exports=a.LabeledCircleMarker=n;a.labeledCircleMarker=function(t,e,i){return new n(t,e,i)}},{"./circle":8,leaflet:undefined,"leaflet-path-drag":2}]},{},[1])(1)});